<?
/******************************************************
* system  : xxx リスク診断
* title   : 死亡計算処理
* content : リスク診断に於ける死亡関連の計算を行う
* version : 1.0
* author  : aizawa
*******************************************************/

// ■リスク診断／死亡データ計算
function calc_sb_data() {
	global $g_encode, $g_const, $g_sheets;

	$n = '死亡';
	$g_sheets[$n] = array();
	$s = &$g_sheets;
	$c = &$g_sheets[$n];

	$c['C40'] = $s['基本']['C59'];
	$c['C41'] = $s['基本']['CV3'] + VB_SUM('基本', 'CW3');
	$c['C42'] = $s['基本']['DF3'];
	$c['C43'] = VB_SUM('基本', 'DK3:DL3');
	$c['C44'] = $s['基本']['DG3'];
	$c['C45'] = 0;
	$c['C46'] = VB_SUM($n, 'C40:C45');
	$c['D40'] = MAX(10, $s['基本']['D14']);
	$c['D41'] = $s['基本']['DW3'] + $s['基本']['DX3'];
	$c['D42'] = $s['基本']['DV3'];
	$c['D43'] = 0;
	$c['D44'] = 0;
	$c['D45'] = 0;
	$c['D46'] = VB_SUM($n, 'D40:D45');
	$c['E41'] = $s['基本']['DY3'];
	$c['E46'] = VB_SUM($n, 'E40:E45');
	$c['F37'] = $s['基本']['D2'];
	$c['F40'] = MAX(0, MIN($c['F37'], $c['C40'] - VB_SUM($n, 'D40:E40')));
	$c['F41'] = MAX(0, MIN($c['F37'] - VB_SUM($n, 'F40:F40'), $c['C41'] - VB_SUM($n, 'D41:E41')));
	$c['F42'] = MAX(0, MIN($c['F37'] - VB_SUM($n, 'F40:F41'), $c['C42'] - VB_SUM($n, 'D42:E42')));
	$c['F43'] = MAX(0, MIN($c['F37'] - VB_SUM($n, 'F40:F42'), $c['C43'] - VB_SUM($n, 'D43:E43', 'H43')));
	$c['F44'] = MAX(0, MIN($c['F37'] - VB_SUM($n, 'F40:F43'), $c['C44'] - VB_SUM($n, 'D44:E44', 'H44')));
	$c['F45'] = $c['F37'] - VB_SUM($n, 'F40:F44');
	$c['F46'] = VB_SUM($n, 'F40:F45');
	$c['G37'] = $s['会社']['D16'];
	$c['G40'] = MAX(0, MIN($c['G37'], $c['C40'] - VB_SUM($n, 'D40:F40')));
	$c['G41'] = MAX(0, MIN($c['G37'] - VB_SUM($n, 'G40:G40'), $c['C41'] - VB_SUM($n, 'D41:F41')));
	$c['G42'] = MAX(0, MIN($c['G37'] - VB_SUM($n, 'G40:G41'), $c['C42'] - VB_SUM($n, 'D42:F42')));
	$c['G43'] = MAX(0, MIN($c['G37'] - VB_SUM($n, 'G40:G42'), $c['C43'] - VB_SUM($n, 'D43:F43')));
	$c['G44'] = MAX(0, MIN($c['G37'] - VB_SUM($n, 'G40:G43'), $c['C44'] - VB_SUM($n, 'D44:F44')));
	$c['G45'] = $c['G37'] - VB_SUM($n, 'G40:G44');
	$c['G46'] = VB_SUM($n, 'G40:G45');
	$c['H43'] = VB_IF($s['基本']['E8'] >= $g_const['年金開始'], 0, VB_IF($s['基本']['C28'] == $g_encode['住宅']['持家'], $s['基本']['J40'], 0));
	$c['H46'] = VB_SUM($n, 'H40:H45');
	$c['I37'] = $s['基本']['DU3'];
	$c['I40'] = MAX(0, MIN($c['I37'], $c['C40'] - VB_SUM($n, 'D40:H40')));
	$c['I41'] = MAX(0, MIN($c['I37'] - VB_SUM($n, 'I40:I40'), $c['C41'] - VB_SUM($n, 'D41:H41')));
	$c['I42'] = MAX(0, MIN($c['I37'] - VB_SUM($n, 'I40:I41'), $c['C42'] - VB_SUM($n, 'D42:H42')));
	$c['I43'] = MAX(0, MIN($c['I37'] - VB_SUM($n, 'I40:I42'), $c['C43'] - VB_SUM($n, 'D43:H43')));
	$c['I44'] = MAX(0, MIN($c['I37'] - VB_SUM($n, 'I40:I43'), $c['C44'] - VB_SUM($n, 'D44:H44')));
	$c['I45'] = $c['I37'] - VB_SUM($n, 'I40:I44');
	$c['I46'] = VB_SUM($n, 'I40:I45');
	$c['J37'] = $s['基本']['C49'];
	$c['J40'] = MAX(0, MIN($c['J37'], $c['C40'] - VB_SUM($n, 'D40:I40')));
	$c['J41'] = MAX(0, MIN($c['J37'] - VB_SUM($n, 'J40:J40'), $c['C41'] - VB_SUM($n, 'D41:I41')));
	$c['J42'] = MAX(0, MIN($c['J37'] - VB_SUM($n, 'J40:J41'), $c['C42'] - VB_SUM($n, 'D42:I42')));
	$c['J43'] = MAX(0, MIN($c['J37'] - VB_SUM($n, 'J40:J42'), $c['C43'] - VB_SUM($n, 'D43:I43')));
	$c['J44'] = MAX(0, MIN($c['J37'] - VB_SUM($n, 'J40:J43'), $c['C44'] - VB_SUM($n, 'D44:I44')));
	$c['J45'] = $c['J37'] - VB_SUM($n, 'J40:J44');
	$c['J46'] = VB_SUM($n, 'J40:J45');
	$c['K37'] = $s['生保']['I37'];
	$c['K40'] = MAX(0, MIN($c['K37'], $c['C40'] - VB_SUM($n, 'D40:J40')));
	$c['K41'] = MAX(0, MIN($c['K37'] - VB_SUM($n, 'K40:K40'), $c['C41'] - VB_SUM($n, 'D41:J41')));
	$c['K42'] = MAX(0, MIN($c['K37'] - VB_SUM($n, 'K40:K41'), $c['C42'] - VB_SUM($n, 'D42:J42')));
	$c['K43'] = MAX(0, MIN($c['K37'] - VB_SUM($n, 'K40:K42'), $c['C43'] - VB_SUM($n, 'D43:J43')));
	$c['K44'] = MAX(0, MIN($c['K37'] - VB_SUM($n, 'K40:K43'), $c['C44'] - VB_SUM($n, 'D44:J44')));
	$c['K45'] = $c['K37'] - VB_SUM($n, 'K40:K44');
	$c['K46'] = VB_SUM($n, 'K40:K45');
	$c['L40'] = VB_SUM($n, 'D40:K40');
	$c['L41'] = VB_SUM($n, 'D41:K41');
	$c['L42'] = VB_SUM($n, 'D42:K42');
	$c['L43'] = VB_SUM($n, 'D43:K43');
	$c['L44'] = VB_SUM($n, 'D44:K44');
	$c['L45'] = VB_SUM($n, 'D45:K45');
	$c['L46'] = VB_SUM($n, 'L40:L45');
	$c['C59'] = $c['C40'];
	$c['C60'] = $c['C41'];
	$c['C61'] = $c['C42'];
	$c['C62'] = $c['C43'];
	$c['C63'] = $c['C44'];
	$c['C64'] = $c['C45'];
	$c['C65'] = $c['C46'];
	$c['D59'] = $c['D40'];
	$c['D60'] = $c['D41'];
	$c['D61'] = $c['D42'];
	$c['D62'] = $c['D43'];
	$c['D63'] = $c['D44'];
	$c['D64'] = $c['D45'];
	$c['D65'] = $c['D46'];
	$c['E59'] = VB_SUM($n, 'E40:G40');
	$c['E60'] = VB_SUM($n, 'E41:G41');
	$c['E61'] = VB_SUM($n, 'E42:G42');
	$c['E62'] = VB_SUM($n, 'E43:G43');
	$c['E63'] = VB_SUM($n, 'E44:G44');
	$c['E64'] = VB_SUM($n, 'E45:G45');
	$c['E65'] = VB_SUM($n, 'E46:G46');
	$c['F59'] = VB_SUM($n, 'H40:J40');
	$c['F60'] = VB_SUM($n, 'H41:J41');
	$c['F61'] = VB_SUM($n, 'H42:J42');
	$c['F62'] = VB_SUM($n, 'H43:J43');
	$c['F63'] = VB_SUM($n, 'H44:J44');
	$c['F64'] = VB_SUM($n, 'H45:J45');
	$c['F65'] = VB_SUM($n, 'H46:J46');
	$c['G59'] = VB_SUM($n, 'I40:K40');
	$c['G60'] = $c['K41'];
	$c['G61'] = $c['K42'];
	$c['G62'] = $c['K43'];
	$c['G63'] = $c['K44'];
	$c['G64'] = $c['K45'];
	$c['G65'] = $c['K46'];
	$c['H65'] = VB_SUM($n, 'D65:G65');

	$c['Q40'] = $s['基本']['D59'];
	$c['Q41'] = $s['基本']['DA5'] + VB_SUM('基本', 'DB5');
	$c['Q42'] = $s['基本']['DF5'];
	$c['Q43'] = VB_SUM('基本', 'DP5:DQ5');
	$c['Q44'] = $s['基本']['DH5'];
	$c['Q45'] = 0;
	$c['Q46'] = VB_SUM($n, 'Q40:Q45');
	$c['R40'] = MAX(10, $s['基本']['E14']);
	$c['R41'] = $s['基本']['EB5'] + $s['基本']['EC5'];
	$c['R42'] = $s['基本']['EA5'];
	$c['R43'] = 0;
	$c['R44'] = 0;
	$c['R45'] = 0;
	$c['R46'] = VB_SUM($n, 'R40:R45');
	$c['S46'] = VB_SUM($n, 'S40:S45');
	$c['T37'] = $s['基本']['E2'];
	$c['T40'] = MAX(0, MIN($c['T37'], $c['Q40'] - VB_SUM($n, 'R40:S40')));
	$c['T41'] = MAX(0, MIN($c['T37'] - VB_SUM($n, 'T40:T40'), $c['Q41'] - VB_SUM($n, 'R41:S41')));
	$c['T42'] = MAX(0, MIN($c['T37'] - VB_SUM($n, 'T40:T41'), $c['Q42'] - VB_SUM($n, 'R42:S42')));
	$c['T43'] = MAX(0, MIN($c['T37'] - VB_SUM($n, 'T40:T42'), $c['Q43'] - VB_SUM($n, 'R43:S43')));
	$c['T44'] = MAX(0, MIN($c['T37'] - VB_SUM($n, 'T40:T43'), $c['Q44'] - VB_SUM($n, 'R44:S44')));
	$c['T45'] = MAX(0, MIN($c['T37'] - VB_SUM($n, 'T40:T44'), $c['Q45'] - VB_SUM($n, 'R45:S45')));
	$c['T46'] = $c['T37'];
	$c['U37'] = $s['会社']['D17'];
	$c['U40'] = MAX(0, MIN($c['U37'], $c['Q40'] - VB_SUM($n, 'R40:T40')));
	$c['U41'] = MAX(0, MIN($c['U37'] - VB_SUM($n, 'U40:U40'), $c['Q41'] - VB_SUM($n, 'R41:T41')));
	$c['U42'] = MAX(0, MIN($c['U37'] - VB_SUM($n, 'U40:U41'), $c['Q42'] - VB_SUM($n, 'R42:T42')));
	$c['U43'] = MAX(0, MIN($c['U37'] - VB_SUM($n, 'U40:U42'), $c['Q43'] - VB_SUM($n, 'R43:T43')));
	$c['U44'] = MAX(0, MIN($c['U37'] - VB_SUM($n, 'U40:U43'), $c['Q44'] - VB_SUM($n, 'R44:T44')));
	$c['U45'] = MAX(0, MIN($c['U37'] - VB_SUM($n, 'U40:U44'), $c['Q45'] - VB_SUM($n, 'R45:T45')));
	$c['U46'] = $c['U37'];
	$c['V43'] = VB_IF($s['基本']['D8'] >= $g_const['年金開始'], 0, VB_IF($s['基本']['C28'] == $g_encode['住宅']['持家'], $s['基本']['J41'], 0));
	$c['V46'] = VB_SUM($n, 'V40:V45');
	$c['W37'] = $s['基本']['DZ5'];
	$c['W40'] = MAX(0, MIN($c['W37'], $c['Q40'] - VB_SUM($n, 'R40:V40')));
	$c['W41'] = MAX(0, MIN($c['W37'] - VB_SUM($n, 'W40:W40'), $c['Q41'] - VB_SUM($n, 'R41:V41')));
	$c['W42'] = MAX(0, MIN($c['W37'] - VB_SUM($n, 'W40:W41'), $c['Q42'] - VB_SUM($n, 'R42:V42')));
	$c['W43'] = MAX(0, MIN($c['W37'] - VB_SUM($n, 'W40:W42'), $c['Q43'] - VB_SUM($n, 'R43:V43')));
	$c['W44'] = MAX(0, MIN($c['W37'] - VB_SUM($n, 'W40:W43'), $c['Q44'] - VB_SUM($n, 'R44:V44')));
	$c['W45'] = MAX(0, MIN($c['W37'] - VB_SUM($n, 'W40:W44'), $c['Q45'] - VB_SUM($n, 'R45:V45')));
	$c['W46'] = $c['W37'];
	$c['X37'] = $s['基本']['C49'];
	$c['X40'] = MAX(0, MIN($c['X37'], $c['Q40'] - VB_SUM($n, 'R40:W40')));
	$c['X41'] = MAX(0, MIN($c['X37'] - VB_SUM($n, 'X40:X40'), $c['Q41'] - VB_SUM($n, 'R41:W41')));
	$c['X42'] = MAX(0, MIN($c['X37'] - VB_SUM($n, 'X40:X41'), $c['Q42'] - VB_SUM($n, 'R42:W42')));
	$c['X43'] = MAX(0, MIN($c['X37'] - VB_SUM($n, 'X40:X42'), $c['Q43'] - VB_SUM($n, 'R43:W43')));
	$c['X44'] = MAX(0, MIN($c['X37'] - VB_SUM($n, 'X40:X43'), $c['Q44'] - VB_SUM($n, 'R44:W44')));
	$c['X45'] = MAX(0, MIN($c['X37'] - VB_SUM($n, 'X40:X44'), $c['Q45'] - VB_SUM($n, 'R45:W45')));
	$c['X46'] = $c['X37'];
	$c['Y37'] = $s['生保']['I171'];
	$c['Y40'] = MAX(0, MIN($c['Y37'], $c['Q40'] - VB_SUM($n, 'R40:X40')));
	$c['Y41'] = MAX(0, MIN($c['Y37'] - VB_SUM($n, 'Y40:Y40'), $c['Q41'] - VB_SUM($n, 'R41:X41')));
	$c['Y42'] = MAX(0, MIN($c['Y37'] - VB_SUM($n, 'Y40:Y41'), $c['Q42'] - VB_SUM($n, 'R42:X42')));
	$c['Y43'] = MAX(0, MIN($c['Y37'] - VB_SUM($n, 'Y40:Y42'), $c['Q43'] - VB_SUM($n, 'R43:X43')));
	$c['Y44'] = MAX(0, MIN($c['Y37'] - VB_SUM($n, 'Y40:Y43'), $c['Q44'] - VB_SUM($n, 'R44:X44')));
	$c['Y45'] = MAX(0, MIN($c['Y37'] - VB_SUM($n, 'Y40:Y44'), $c['Q45'] - VB_SUM($n, 'R45:X45')));
	$c['Y46'] = $c['Y37'];
	$c['Z40'] = VB_SUM($n, 'R40:Y40');
	$c['Z41'] = VB_SUM($n, 'R41:Y41');
	$c['Z42'] = VB_SUM($n, 'R42:Y42');
	$c['Z43'] = VB_SUM($n, 'R43:Y43');
	$c['Z44'] = VB_SUM($n, 'R44:Y44');
	$c['Z45'] = VB_SUM($n, 'R45:Y45');
	$c['Z46'] = VB_SUM($n, 'Z40:Z45');
	$c['Q59'] = $c['Q40'];
	$c['Q60'] = $c['Q41'];
	$c['Q61'] = $c['Q42'];
	$c['Q62'] = $c['Q43'];
	$c['Q63'] = $c['Q44'];
	$c['Q64'] = $c['Q45'];
	$c['Q65'] = $c['Q46'];
	$c['R59'] = $c['R40'];
	$c['R60'] = $c['R41'];
	$c['R61'] = $c['R42'];
	$c['R62'] = $c['R43'];
	$c['R63'] = $c['R44'];
	$c['R64'] = $c['R45'];
	$c['R65'] = $c['R46'];
	$c['S44'] = 0;
	$c['S59'] = VB_SUM($n, 'S40:T40');
	$c['S60'] = VB_SUM($n, 'S41:T41');
	$c['S61'] = VB_SUM($n, 'S42:T42');
	$c['S62'] = VB_SUM($n, 'S43:T43');
	$c['S63'] = $c['S44'];
	$c['S64'] = VB_SUM($n, 'S45:T45');
	$c['S65'] = VB_SUM($n, 'S46:U46');
	$c['T59'] = VB_SUM($n, 'V40:X40');
	$c['T60'] = VB_SUM($n, 'V41:X41');
	$c['T61'] = VB_SUM($n, 'V42:X42');
	$c['T62'] = VB_SUM($n, 'V43:X43');
	$c['T63'] = $c['T44'];
	$c['T64'] = VB_SUM($n, 'V44:X44');
	$c['T65'] = VB_SUM($n, 'V46:X46');
	$c['U59'] = $c['Y40'];
	$c['U60'] = $c['Y41'];
	$c['U61'] = $c['Y42'];
	$c['U62'] = $c['Y43'];
	$c['U63'] = $c['Y44'];
	$c['U64'] = $c['Y45'];
	$c['U65'] = $c['Y46'];
	$c['V65'] = VB_SUM($n, 'R65:U65');

	$c['J4'] = $c['C40'];
	$c['J5'] = $c['C41'];
	$c['J6'] = $c['C42'];
	$c['J7'] = $c['C43'];
	$c['J8'] = $c['C44'];
	$c['J9'] = VB_SUM($n, 'J4:J8');
	$c['J11'] = $c['D65'];
	$c['J12'] = $c['E65'];
	$c['J13'] = $c['F65'];
	$c['J14'] = $c['G65'];
	$c['J15'] = VB_SUM($n, 'J11:J14');
	$c['J16'] = $c['J15'] / $c['J9'];

	$c['X4'] = $c['Q40'];
	$c['X5'] = $c['Q41'];
	$c['X6'] = $c['Q42'];
	$c['X7'] = $c['Q43'];
	$c['X8'] = $c['Q44'];
	$c['X9'] = VB_SUM($n, 'X4:X8');
	$c['X11'] = $c['R65'];
	$c['X12'] = $c['S65'];
	$c['X13'] = $c['T65'];
	$c['X14'] = $c['U65'];
	$c['X15'] = VB_SUM($n, 'X11:X14');
	$c['X16'] = $c['X15'] / $c['X9'];

/* 未使用
	$c['K65'] = 1;
*/
	$c['B27'] = $c['C40'];
	$c['B28'] = $c['C41'];
	$c['B29'] = $c['C42'];
	$c['B30'] = $c['C43'];
	$c['B31'] = $c['C44'];
	$c['B32'] = $c['C46'];
	$c['C27'] = VB_IF($c['C40'] > 0, $c['D59'] / $c['C40'] * 100, 0);
	$c['C28'] = VB_IF($c['C41'] > 0, $c['D60'] / $c['C41'] * 100, 0);
	$c['C29'] = VB_IF($c['C42'] > 0, $c['D61'] / $c['C42'] * 100, 0);
	$c['C30'] = VB_IF($c['C43'] > 0, $c['D62'] / $c['C43'] * 100, 0);
	$c['C31'] = VB_IF($c['C44'] > 0, $c['D64'] / $c['C44'] * 100, 0);
	$c['C32'] = VB_IF($c['C46'] > 0, $c['D65'] / $c['C46'] * 100, 0);
	$c['D27'] = VB_IF($c['C40'] > 0, $c['E59'] / $c['C40'] * 100, 0);
	$c['D28'] = VB_IF($c['C41'] > 0, $c['E60'] / $c['C41'] * 100, 0);
	$c['D29'] = VB_IF($c['C42'] > 0, $c['E61'] / $c['C42'] * 100, 0);
	$c['D30'] = VB_IF($c['C43'] > 0, $c['E62'] / $c['C43'] * 100, 0);
	$c['D31'] = VB_IF($c['C44'] > 0, $c['E64'] / $c['C44'] * 100, 0);
	$c['D32'] = VB_IF($c['C46'] > 0, $c['E65'] / $c['C46'] * 100, 0);
	$c['E27'] = VB_IF($c['C40'] > 0, $c['F59'] / $c['C40'] * 100, 0);
	$c['E28'] = VB_IF($c['C41'] > 0, $c['F60'] / $c['C41'] * 100, 0);
	$c['E29'] = VB_IF($c['C42'] > 0, $c['F61'] / $c['C42'] * 100, 0);
	$c['E30'] = VB_IF($c['C43'] > 0, $c['F62'] / $c['C43'] * 100, 0);
	$c['E31'] = VB_IF($c['C44'] > 0, $c['F63'] / $c['C44'] * 100, 0);
	$c['E32'] = VB_IF($c['C46'] > 0, $c['F65'] / $c['C46'] * 100, 0);
	$c['F27'] = VB_IF($c['C40'] > 0, $c['G59'] / $c['C40'] * 100, 0);
	$c['F28'] = VB_IF($c['C41'] > 0, $c['G60'] / $c['C41'] * 100, 0);
	$c['F29'] = VB_IF($c['C42'] > 0, $c['G61'] / $c['C42'] * 100, 0);
	$c['F30'] = VB_IF($c['C43'] > 0, $c['G62'] / $c['C43'] * 100, 0);
	$c['F31'] = VB_IF($c['C44'] > 0, $c['G63'] / $c['C44'] * 100, 0);
	$c['F32'] = VB_IF($c['C46'] > 0, $c['G65'] / $c['C46'] * 100, 0);
/* 未使用
	$c['M46'] = VB_IF($c['C46'] > 0, $c['L46'] / $c['C46'], 0);
	$c['B51'] = VB_IF($c['M46'] < 1, $s['基本']['C36'] / ($c['C46'] - $c['L46']), "---");
	$c['C51'] = VB_IF($c['B51'] == "---", 0, (1 - $c['M46']) * MIN(1, $c['B51'] / 4) * 100);
	$c['B69'] = $c['C51'];
	$c['I66'] = $c['B69'];
	$c['J65'] = MAX(100, VB_SUM($n, 'C32:E32') + MAX(0, $c['I66']));
	$c['C33'] = ($c['C32'] / $c['J65'] * $c['K65']) * 100;
	$c['D33'] = ($c['D32'] / $c['J65'] * $c['K65']) * 100;
	$c['E33'] = ($c['E32'] / $c['J65'] * $c['K65']) * 100;
	$c['F33'] = ($c['F32'] / $c['J65'] * $c['K65']) * 100;
*/
	$c['G27'] = VB_SUM($n, 'C27:F27');
	$c['G28'] = VB_SUM($n, 'C28:F28');
	$c['G29'] = VB_SUM($n, 'C29:F29');
	$c['G30'] = VB_SUM($n, 'C30:F30');
	$c['G31'] = VB_SUM($n, 'C31:F31');
	$c['G32'] = VB_SUM($n, 'C32:F32');
/* 未使用
	$c['G33'] = VB_SUM($n, 'C33:F33');
*/

	$c['Y65'] = 1;
	$c['P27'] = $c['Q40'];
	$c['P28'] = $c['Q41'];
	$c['P29'] = $c['Q42'];
	$c['P30'] = $c['Q43'];
	$c['P31'] = $c['Q45'];
	$c['P32'] = $c['Q46'];
	$c['Q27'] = VB_IF($c['Q40'] > 0, $c['R59'] / $c['Q40'] * 100, 0);
	$c['Q28'] = VB_IF($c['Q41'] > 0, $c['R60'] / $c['Q41'] * 100, 0);
	$c['Q29'] = VB_IF($c['Q42'] > 0, $c['R61'] / $c['Q42'] * 100, 0);
	$c['Q30'] = VB_IF($c['Q43'] > 0, $c['R62'] / $c['Q43'] * 100, 0);
	$c['Q31'] = VB_IF($c['Q44'] > 0, $c['R63'] / $c['Q44'] * 100, 0);
	$c['Q32'] = VB_IF($c['Q46'] > 0, $c['R65'] / $c['Q46'] * 100, 0);
	$c['R27'] = VB_IF($c['Q40'] > 0, $c['S59'] / $c['Q40'] * 100, 0);
	$c['R28'] = VB_IF($c['Q41'] > 0, $c['S60'] / $c['Q41'] * 100, 0);
	$c['R29'] = VB_IF($c['Q42'] > 0, $c['S61'] / $c['Q42'] * 100, 0);
	$c['R30'] = VB_IF($c['Q43'] > 0, $c['S62'] / $c['Q43'] * 100, 0);
	$c['R31'] = VB_IF($c['Q44'] > 0, $c['S63'] / $c['Q44'] * 100, 0);
	$c['R32'] = VB_IF($c['Q46'] > 0, $c['S65'] / $c['Q46'] * 100, 0);
	$c['S27'] = VB_IF($c['C40'] > 0, $c['T59'] / $c['C40'] * 100, 0);
	$c['S28'] = VB_IF($c['C41'] > 0, $c['T60'] / $c['C41'] * 100, 0);
	$c['S29'] = VB_IF($c['C42'] > 0, $c['T61'] / $c['C42'] * 100, 0);
	$c['S30'] = VB_IF($c['C43'] > 0, $c['T62'] / $c['C43'] * 100, 0);
	$c['S31'] = VB_IF($c['C44'] > 0, $c['T63'] / $c['C44'] * 100, 0);
	$c['S32'] = VB_IF($c['Q46'] > 0, $c['T65'] / $c['Q46'] * 100, 0);
	$c['T27'] = VB_IF($c['C40'] > 0, $c['U59'] / $c['C40'] * 100, 0);
	$c['T28'] = VB_IF($c['C41'] > 0, $c['U60'] / $c['C41'] * 100, 0);
	$c['T29'] = VB_IF($c['C42'] > 0, $c['U61'] / $c['C42'] * 100, 0);
	$c['T30'] = VB_IF($c['C43'] > 0, $c['U62'] / $c['C43'] * 100, 0);
	$c['T31'] = VB_IF($c['C44'] > 0, $c['U63'] / $c['C44'] * 100, 0);
	$c['T32'] = VB_IF($c['Q46'] > 0, $c['U65'] / $c['Q46'] * 100, 0);
/* 未使用
	$c['AA46'] = VB_IF($c['Q46'] > 0, $c['Z46'] / $c['Q46'], 0);
	$c['P51'] = VB_IF($c['AA46'] < 1, $s['基本']['C36'] / ($c['Q46'] - $c['Z46']), "---");
	$c['Q51'] = VB_IF($c['P51'] == "---", 0, (1 - $c['AA46']) * MIN(1, $c['P51'] / 4) * 100);
	$c['P69'] = $c['Q51'];
	$c['W66'] = $c['P69'];
	$c['X65'] = MAX(100, VB_SUM($n, 'Q32:S32') + MAX(0, $c['W66']));
	$c['Q33'] = ($c['Q32'] / $c['X65'] * $c['Y65']) * 100;
	$c['R33'] = ($c['R32'] / $c['X65'] * $c['Y65']) * 100;
	$c['S33'] = ($c['S32'] / $c['X65'] * $c['Y65']) * 100;
	$c['T33'] = ($c['T32'] / $c['X65'] * $c['Y65']) * 100;
*/
	$c['U27'] = VB_SUM($n, 'Q27:T27');
	$c['U28'] = VB_SUM($n, 'Q28:T28');
	$c['U29'] = VB_SUM($n, 'Q29:T29');
	$c['U30'] = VB_SUM($n, 'Q30:T30');
	$c['U31'] = VB_SUM($n, 'Q31:T31');
	$c['U32'] = VB_SUM($n, 'Q32:T32');
/* 未使用
	$c['U33'] = VB_SUM($n, 'Q33:T33');
*/
}
?>