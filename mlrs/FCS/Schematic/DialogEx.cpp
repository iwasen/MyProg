//*****************************************************************************************************
//  1. ファイル名
//		DialogEx.cpp
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		拡張ダイアログクラスの実装
//----------------------------------------------------------------------------------------------------
//  3. 備考
//*****************************************************************************************************

#include "stdafx.h"
#include "DialogEx.h"


// CDialogEx ダイアログ

IMPLEMENT_DYNAMIC(CDialogEx, CDialog)

//*****************************************************************************************************
//  1. 関数名
//		CDialogEx::CDialogEx
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		コンストラクタ
//----------------------------------------------------------------------------------------------------
//  3. パラメータ
//		UINT		nID				[I] ダイアログID
//		CWnd		*pParent		[I] 親ウィンドウへのポインタ
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
CDialogEx::CDialogEx(UINT nID, CWnd* pParent)
	: CDialog(nID, pParent)
{
	// メンバ変数を初期化
	m_nID = nID;
	m_bModeless = FALSE;
}

void CDialogEx::DoDataExchange(CDataExchange* pDX)
{
	CDialog::DoDataExchange(pDX);
}


BEGIN_MESSAGE_MAP(CDialogEx, CDialog)
END_MESSAGE_MAP()


//*****************************************************************************************************
//  1. 関数名
//		CDialogEx::DoModeless
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		モードレスでダイアログを開く
//----------------------------------------------------------------------------------------------------
//  3. パラメータ
//		無し
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		BOOL	TRUE：正常　FALSE：エラー
//*****************************************************************************************************
BOOL CDialogEx::DoModeless(CWnd *pParent)
{
	if (pParent != NULL)
		m_pParentWnd = pParent;

	// モードレスでウィンドウを作成
	if (!CDialog::Create(m_nID, m_pParentWnd))
		return FALSE;

	// モードレスフラグセット
	m_bModeless = TRUE;

	// ウィンドウを表示
	ShowWindow(SW_SHOW);

	return TRUE;
}

//*****************************************************************************************************
//  1. 関数名
//		CDialogEx::OnCancel
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		キャンセルボタンクリック処理
//----------------------------------------------------------------------------------------------------
//  3. パラメータ
//		無し
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CDialogEx::OnCancel()
{
	if (m_bModeless)
		DestroyWindow();
	else
		EndDialog(IDCANCEL);
}

//*****************************************************************************************************
//  1. 関数名
//		CDialogEx::OnOK
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		OKボタンクリック処理
//----------------------------------------------------------------------------------------------------
//  3. パラメータ
//		無し
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CDialogEx::OnOK()
{
	// 何もしない
}

//*****************************************************************************************************
//  1. 関数名
//		CDialogEx::PostNcDestroy
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		ウィンドウ破棄
//----------------------------------------------------------------------------------------------------
//  3. パラメータ
//		無し
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CDialogEx::PostNcDestroy()
{
	CDialog::PostNcDestroy();

	// モードレスなら自分自身を解放
	if (m_bModeless)
		delete this;
}
