//*****************************************************************************************************
//  1. ファイル名
//		TitlePrint.cpp
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		印刷タイトルのクラスの実装
//----------------------------------------------------------------------------------------------------
//  3. 備考
//----------------------------------------------------------------------------------------------------
//  4. 履歴
//		2008.01.01 M.Hama 新規作成
//*****************************************************************************************************
#include "StdAfx.h"
#include "TitlePrint.h"

CTitlePrint::CTitlePrint()
{
}

CTitlePrint::~CTitlePrint()
{
}

//*****************************************************************************************************
//  1. 関数名
//		CTitlePrint::StartTitle
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		グラフタイトル印刷開始処理
//----------------------------------------------------------------------------------------------------
//  3. パラメータ説明
//		CDC&		dc			[I] CDC
//		CRect		rectView	[I] データ印字部分のCRect
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CTitlePrint::StartTitle(CDC& dc, CRect rectView)
{
	m_dc = &dc;
	m_Rect = rectView;

	// フォント作成
	CFont fontTitle;
	fontTitle.CreatePointFont(80, "MS UI Gothic", m_dc);

	// フォントを選択
	m_pFontOrg = m_dc->SelectObject(&fontTitle);

}

//*****************************************************************************************************
//  1. 関数名
//		CTitlePrint::EndTitle
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		グラフタイトル印刷終了処理
//----------------------------------------------------------------------------------------------------
//  3. パラメータ説明
//		無し
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CTitlePrint::EndTitle()
{
	// フォントの選択を解除
	m_dc->SelectObject(m_pFontOrg);
}

//*****************************************************************************************************
//  1. 関数名
//		CTitlePrint::PrintMid
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		グラフタイトル印刷（センター）
//----------------------------------------------------------------------------------------------------
//  3. パラメータ説明
//		int			nLine		[I] 行
//		LPCSTR		pTitle		[I] 印刷文字列
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CTitlePrint::PrintMid(int nLine, LPCSTR pTitle)
{
	// タイトルのサイズを取得
	CSize sizeText = m_dc->GetOutputTextExtent(pTitle);

	// タイトルを印刷
	m_dc->TextOut(m_Rect.CenterPoint().x - sizeText.cx / 2, sizeText.cy * nLine, pTitle);
}

//*****************************************************************************************************
//  1. 関数名
//		CTitlePrint::PrintLeft
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		グラフタイトル印刷（左詰め）
//----------------------------------------------------------------------------------------------------
//  3. パラメータ説明
//		int			nLine		[I] 行
//		LPCSTR		pTitle		[I] 印刷文字列
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CTitlePrint::PrintLeft(int nLine, LPCSTR pTitle)
{
	// タイトルのサイズを取得
	CSize sizeText = m_dc->GetOutputTextExtent(pTitle);

	// タイトルを印刷
	m_dc->TextOut(m_Rect.left, sizeText.cy * nLine, pTitle);
}

//*****************************************************************************************************
//  1. 関数名
//		CTitlePrint::PrintRight
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		グラフタイトル印刷（右詰め）
//----------------------------------------------------------------------------------------------------
//  3. パラメータ説明
//		int			nLine		[I] 行
//		LPCSTR		pTitle		[I] 印刷文字列
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CTitlePrint::PrintRight(int nLine, LPCSTR pTitle)
{
	// タイトルのサイズを取得
	CSize sizeText = m_dc->GetOutputTextExtent(pTitle);

	// タイトルを印刷
	m_dc->TextOut(m_Rect.right - sizeText.cx, sizeText.cy * nLine, pTitle);
}

//*****************************************************************************************************
//  1. 関数名
//		CTitlePrint::PrintDir
//----------------------------------------------------------------------------------------------------
//  2. 機能
//		グラフタイトル印刷（右詰め）
//----------------------------------------------------------------------------------------------------
//  3. パラメータ説明
//		int			x			[I] X座標
//		int			nLine		[I] 行
//		LPCSTR		pTitle		[I] 印刷文字列
//----------------------------------------------------------------------------------------------------
//  4. 戻り値
//		無し
//*****************************************************************************************************
void CTitlePrint::PrintDir(int x, int nLine, LPCSTR pTitle)
{
	// タイトルのサイズを取得
	CSize sizeText = m_dc->GetOutputTextExtent(pTitle);

	// タイトルを印刷
	m_dc->TextOut(m_Rect.left + x, sizeText.cy * nLine, pTitle);
}
